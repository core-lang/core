fun main(): Unit {
  testBothEmpty();
  testNeedleEmpty();
  testHaystackEmpty();
  testNeedleLarger();
  testSuccess();
  testMultipleMatch();
  testFailure();
}

fun testBothEmpty(): Unit {
  assert("".indexOfFirst("").has(0i64));
}

fun testNeedleEmpty(): Unit {
  assert("abc".indexOfFirst("").has(0i64));
}

fun testHaystackEmpty(): Unit {
  assert("".indexOfFirst("abc").isNone());
}

fun testNeedleLarger(): Unit {
  assert("abc".indexOfFirst("abcdef").isNone());
}

fun testSuccess(): Unit {
  assert("abcdef".indexOfFirst("abc").has(0i64));
  assert("defabc".indexOfFirst("abc").has(3i64));
  assert("ababbaadef".indexOfFirst("aa").has(5i64));
  assert("apapplapple".indexOfFirst("apple").has(6i64));
}

fun testMultipleMatch(): Unit {
  assert("abcdefabc".indexOfFirst("abc").has(0i64));
}

fun testFailure(): Unit {
  assert("def".indexOfFirst("abc").isNone());
}
